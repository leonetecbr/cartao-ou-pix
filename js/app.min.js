const installmentsDiv=$("#installments-div"),installments=$("#installments"),value=$("#installments-value"),quantity=$("#installments-quantity"),valueInCredit=$("#value-in-credit"),valueInCash=$("#value-in-cash"),inCardDiv=$("#in-card-div"),inCard=$("#in-card"),textInCard=$("#text-in-card"),incomeAdditionalDiv=$("#percent-income-additional-div"),incomeAdditional=$("#percent-income-additional"),benefitsCashback=$("#benefits-credit-cashback"),benefitsPoints=$("#benefits-credit-points"),benefitsCashbackDiv=$("#benefits-credit-cashback-div"),benefitsPointsDiv=$("#benefits-credit-points-div"),benefits=$('input[name="benefits-credit"]'),cashbackValue=$("percent-cashback"),pointsQuantity=$("#points"),pointsValue=$("#value-per-points"),plusPercent=$("#plus-percent");let dollar,cdi,selic;const tooltipTriggerList=[].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'));function changeInstallments(){let a=quantity.val()*value.val();valueInCredit.val(a)}function calcBenefits(){if(inCard.is(":checked"))return 0;let a=$('input[name="benefits-credit"]:checked').val(),b=$("#currency");if("1"===a){let c=benefitsCashback.val();return valueInCredit.val()/100*c}return"2"===a?("1"===b.val()?valueInCredit.val()/dollar*pointsQuantity.val():valueInCredit.val()*pointsQuantity.val())/1e3*pointsValue.val():0}function calcIncome(){let g=$("#indexer").val(),a=0,c,d=$("#percent-income").val(),e=plusPercent.is(":checked")?incomeAdditional.val():0,h=$("#free-irrf").is(":checked");if(c="1"===g?d/100*cdi+e:"2"===g?d/100*selic+e:parseFloat(d)+parseFloat(e),installments.is(":checked")){let i=valueInCredit.val(),k=quantity.val(),l=value.val();for(let b=1;b<=k;b++){let f=i/100*c,j;j=h?0:b<=6?22.5:b>6&&b<12?20:17.5,f-=f/100*j,a+=f,i-=l}inCard.is(":checked")&&(a-=valueInCash.val()/100*c)}else{let m=h?0:22.5;a+=valueInCash.val()/100*c,a-=a/100*m}return a}tooltipTriggerList.map(function(a){return new bootstrap.Tooltip(a)}),$("#calculator").on("submit",function(d){if(d.preventDefault(),this.checkValidity()){let e=parseInt(valueInCredit.val()),f=parseInt(valueInCash.val()),b=$("#result"),a="\xc9 mais vantajoso pagar ",c;(c=((e=e-calcBenefits()-calcIncome())-f).toFixed(2))<0?(a+=textInCard.html()+"! A diferen\xe7a \xe9 de ",a+=Math.abs(c).toLocaleString("pt-br",{style:"currency",currency:"BRL"}),b.html(a).addClass("alert-success").removeClass("alert-info").removeClass("alert-warning")):c>0?(a+="\xe0 vista! A diferen\xe7a \xe9 de ",a+=c.toLocaleString("pt-br",{style:"currency",currency:"BRL"}),b.html(a).addClass("alert-info").removeClass("alert-success").removeClass("alert-warning")):(a="A diferen\xe7a entre o pagamento em cart\xe3o e \xe0 vista nesse caso \xe9 nula, escolha o mais conveniente.",b.html(a).addClass("alert-warning").removeClass("alert-success").removeClass("alert-warning")),b.removeClass("d-none")}else d.stopPropagation();$(this).addClass("was-validated")}),installments.on("change",()=>{installments.is(":checked")?(installmentsDiv.removeClass("d-none").addClass("d-flex"),value.attr("required","").on("change",changeInstallments),quantity.attr("required","").on("change",changeInstallments),valueInCredit.attr("readonly",""),inCardDiv.removeClass("d-none"),textInCard.html("parcelado")):(installmentsDiv.addClass("d-none").removeClass("d-flex"),value.removeAttr("required"),quantity.removeAttr("required"),valueInCredit.removeAttr("readonly"),inCardDiv.addClass("d-none"),inCard.prop("checked",!1),textInCard.html("no cart\xe3o"))}),plusPercent.on("change",()=>{plusPercent.is(":checked")?(incomeAdditionalDiv.removeClass("d-none"),incomeAdditional.attr("required","")):(incomeAdditionalDiv.addClass("d-none"),incomeAdditional.removeAttr("required"))}),benefits.on("change",()=>{benefitsCashback.is(":checked")?(benefitsCashbackDiv.removeClass("d-none"),benefitsPointsDiv.addClass("d-none"),cashbackValue.attr("required",""),pointsQuantity.removeAttr("required"),pointsValue.removeAttr("required")):benefitsPoints.is(":checked")?(benefitsCashbackDiv.addClass("d-none"),benefitsPointsDiv.removeClass("d-none"),pointsValue.attr("required",""),pointsQuantity.attr("required",""),cashbackValue.removeAttr("required")):(benefitsPointsDiv.addClass("d-none"),benefitsCashbackDiv.addClass("d-none"),cashbackValue.removeAttr("required"),pointsValue.removeAttr("required"),pointsQuantity.removeAttr("required"))}),axios.get("/api.php").then(a=>{200===a.status?(cdi=a.data.cdi,selic=a.data.selic,dollar=a.data.usd,$("#dollar-value").html(dollar.toLocaleString("pt-br",{style:"currency",currency:"BRL"}))):console.error(a)}).catch(a=>console.error(a))